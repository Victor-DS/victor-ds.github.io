<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Chat with (AI) Victor!</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="favicon.png">
	<style>
		:root {
			--bg: #0b0c10;
			--panel: #121316;
			--text: #e5e7eb;
			--muted: #9ca3af;
			--accent: #22d3ee;
			--border: #1f2937;
		}

		* { box-sizing: border-box; }

		html, body {
			height: 100%;
		}

		body {
			margin: 0;
			background: var(--bg);
			color: var(--text);
			font: 16px/1.5 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
		}

		.container {
			min-height: 100dvh;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 24px;
		}

		.panel {
			width: 100%;
			max-width: 720px;
			background: var(--panel);
			border: 1px solid var(--border);
			border-radius: 14px;
			padding: 20px;
			box-shadow: 0 10px 30px rgba(0,0,0,0.3);
		}

		.header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 14px;
		}

		.title {
			margin: 0;
			font-size: 20px;
			font-weight: 700;
			letter-spacing: 0.2px;
		}

		.subtitle {
			margin: 2px 0 0 0;
			font-size: 12px;
			color: var(--muted);
		}

		.form {
			display: grid;
			grid-template-columns: 1fr auto;
			gap: 10px;
			margin-top: 14px;
		}

		.input {
			width: 100%;
			padding: 12px 14px;
			border: 1px solid var(--border);
			background: #0e1013;
			color: var(--text);
			border-radius: 10px;
			outline: none;
		}

		.input::placeholder { color: #6b7280; }
		.input:focus { border-color: #30363d; }

		.button {
			padding: 10px 14px;
			border: 1px solid var(--border);
			background: #0e1013;
			color: var(--text);
			border-radius: 10px;
			cursor: pointer;
			transition: transform 120ms ease;
		}

		.button:hover { transform: translateY(-1px); }
		.button[disabled] { opacity: 0.6; cursor: not-allowed; transform: none; }

		.answer {
			margin-top: 16px;
			padding: 14px;
			border: 1px dashed var(--border);
			border-radius: 12px;
			white-space: pre-wrap;
			word-wrap: break-word;
			min-height: 52px;
			color: var(--text);
		}

		.hint {
			margin-top: 10px;
			font-size: 12px;
			color: var(--muted);
		}
	</style>
</head>
<body>
	<div class="container">
		<main class="panel" role="main">
			<div class="header">
				<div>
					<h1 class="title">Chat with (AI) Victor!</h1>
					<p class="subtitle">Ask a question and press Enter.</p>
				</div>
			</div>

			<form id="chat-form" class="form" autocomplete="off">
				<input id="question-input" class="input" type="text" name="question" placeholder="Type your question…" aria-label="Question" required>
				<button id="send-button" class="button" type="submit" aria-label="Send">Send</button>
			</form>

			<section id="answer" class="answer" aria-live="polite" aria-atomic="true"></section>
			<p class="hint">Only the latest answer is shown. No history is kept.</p>
		</main>
	</div>

	<script>
		(function () {
			var API_URL = 'https://wem6t4iqbf.execute-api.us-east-1.amazonaws.com/prod/';
			var form = document.getElementById('chat-form');
			var input = document.getElementById('question-input');
			var sendButton = document.getElementById('send-button');
			var answer = document.getElementById('answer');

			function setLoading(isLoading) {
				input.disabled = isLoading;
				sendButton.disabled = isLoading;
				if (isLoading) {
					answer.textContent = 'Thinking…';
				} else if (!answer.textContent) {
					answer.textContent = '';
				}
			}

			function withTimeout(promise, ms) {
				var controller = new AbortController();
				var id = setTimeout(function () { controller.abort(); }, ms);
				return Promise.race([
					promise(controller.signal).finally(function () { clearTimeout(id); })
				]);
			}

			form.addEventListener('submit', function (e) {
				e.preventDefault();
				var question = (input.value || '').trim();
				if (!question) { return; }

				answer.textContent = '';
				setLoading(true);

				withTimeout(function (signal) {
					return fetch(API_URL, {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' },
						mode: 'cors',
						body: JSON.stringify({ question: question }),
						signal: signal
					});
				}, 30000)
				.then(function (res) {
					if (!res.ok) { throw new Error('Request failed: ' + res.status); }
					return res.json();
				})
				.then(function (data) {
					var text = data && typeof data.answer === 'string' ? data.answer.trim() : '';
					answer.textContent = text || '(Empty answer)';
				})
				.catch(function (err) {
					var message = (err && err.name === 'AbortError') ? 'Request timed out. Try again.' : 'Something went wrong. Please try again.';
					answer.textContent = message;
				})
				.finally(function () {
					setLoading(false);
					input.focus();
				});
			});

			// Focus input on load for convenience
			window.addEventListener('DOMContentLoaded', function () {
				input.focus();
			});
		})();
	</script>
</body>
</html>
